# 不动产文档生成算子

## 功能说明

本算子将不动产数据（JSON 格式）填充到 Word 模板中，生成不动产信息查询结果文档。

## 输入参数

算子不需要额外参数，直接从输入数据中读取 JSON 格式的不动产信息。

## 输入格式

算子期望输入为 JSON 数组格式，包含不动产信息数据：

```json
[
    {
        "index": 1,
        "省份": "东华省",
        "姓名（证件号码）": "王伟（110101199001011234）",
        "查询目的": "担保用",
        "电脑查册人": "ABCD-EFGH",
        "证明流水号": "20250115123456",
        "打印日期": "2025年01月15日 14:30:25",
        "表格数据": [
            {
                "序号": 1,
                "状态": "正常",
                "合同号": "123456789012345",
                "地址": "东华省东华市人民路小区5栋2单元1203室",
                "产权证号": "东华12345",
                "规划用途": "住宅",
                "建筑面积": "120.5㎡",
                "数据来源": "东华市不动产登记中心"
            }
        ]
    }
]
```

## Word 模板

算子使用内置的 Word 模板文件，模板必须包含以下占位符：

### 段落占位符

- `{{省份}}` - 省份名称
- `{{姓名（证件号码）}}` - 姓名和身份证号
- `{{姓名}}` - 仅姓名
- `{{查询目的}}` - 查询目的
- `{{电脑查册人}}` - 电脑查册人编号
- `{{证明流水号}}` - 证明流水号
- `{{打印日期}}` - 打印日期

### 表格占位符

- `{{序号}}` - 序号
- `{{状态}}` - 状态
- `{{合同号}}` - 合同号
- `{{地址}}` - 地址
- `{{产权证号}}` - 产权证号
- `{{规划用途}}` - 规划用途
- `{{建筑面积}}` - 建筑面积
- `{{数据来源}}` - 数据来源

## 输出格式

算子输出为 Word 文档二进制数据（docx 格式），存储在 `sample['data']` 字段中。

## 注意事项

1. **模板文件必须存在**：算子包中必须包含 `templates/不动产信息查询结果模板.docx` 文件
2. **当前版本只处理第一条数据**：输入 JSON 数组中只处理第一条数据生成单个文档
3. **模板格式要求**：Word 模板必须包含上述占位符，否则填充失败
4. **表格动态行**：模板中的表格会根据数据中的 `表格数据` 数组自动扩展行数

## 使用场景

适用于需要生成不动产查询结果 Word 文档的场景，如：

- 数据标注训练
- 系统功能测试
- 文档生成流程测试

## 模板准备

请确保算子包中包含以下文件结构：

```
不动产信息查询结果-step2-生成文档/
├── templates/
│   └── 不动产信息查询结果模板.docx  # Word 模板文件
├── __init__.py
├── metadata.yml
├── process.py
└── requirements.txt
```
