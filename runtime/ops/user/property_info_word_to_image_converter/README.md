# Word转图片算子

## 功能说明

本算子用于将Word文档转换为高质量JPG图片，支持以下功能：

- Word → PDF 转换（带重试机制）
- PDF → JPG 转换（支持多页）
- 自动跳过空白页（大部分区域是白色的页面）
- 支持图片DPI配置（150-600）
- 支持图片路径和Base64编码两种输出格式

## 使用场景

- 将填充后的Word文档转换为JPG图片
- 批量转换Word文档
- 自动化文档转图片流程

## 参数说明

| 参数           | 类型     | 默认值 | 说明                                         |
| -------------- | -------- | ------ | -------------------------------------------- |
| imageDPI       | 滑动条   | 300    | 图片分辨率DPI，数值越高图片越清晰（150-600） |
| skipBlankPages | 开关     | true   | 是否自动跳过空白页（大部分区域是白色的页面） |
| outputFormat   | 下拉选择 | path   | 输出格式：图片路径或Base64编码               |
| maxRetries     | 数字输入 | 3      | Word转PDF失败时的最大重试次数（1-5）         |

## 输出示例

### 图片路径格式

```
JPG图片已生成（共2张）:

图片1:
/path/to/不动产查询表_001.jpg

图片2:
/path/to/不动产查询表_001-1.jpg
```

### Base64编码格式

```
Base64编码的JPG图片（共2张）:

图片1:
/9j/4AAQSkZJRg...

图片2:
/9j/4AAQSkZJRg...
```

## 空白页检测逻辑

算子使用两种方法检测空白页：

1. **整页唯一颜色数检测**：如果整页只有很少的颜色（如<5种），很可能是空白页
2. **多区域采样检测**：将页面分成20个水平区域进行采样，如果所有区域的颜色数都≤3，则认为是空白页

## 注意事项

1. 需要确保 `docx2pdf` 和 `pdf2image` 依赖已安装
2. Word 文档路径应从 `sample['export_path']` 获取（上游算子输出）
3. 多页文档会生成多张图片，文件名格式为 `原文件名-序号.jpg`
4. 空白页检测可能会误判，建议检查生成的图片
5. Word转PDF可能失败，算子会自动重试（默认3次）
6. 转换过程中会生成临时 PDF 文件，转换完成后自动清理
7. 输出为图片路径格式时，第一张图片路径会保存到 `sample['export_path']`

## 版本历史

- v1.0.0: 首次发布
    - 支持Word转JPG图片功能
    - 支持多页文档处理
    - 支持自动跳过空白页
    - 支持图片DPI配置
    - 支持图片路径和Base64编码两种输出格式
    - 支持Word转PDF重试机制
