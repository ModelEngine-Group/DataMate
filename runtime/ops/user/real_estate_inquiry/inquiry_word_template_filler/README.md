# Word模板填充算子

## 功能说明

本算子用于将不动产数据填充到Word模板中，生成查询结果文档。支持以下功能：

- 从输入文本解析JSON数据或使用固定数据
- 自动填充Word模板中的占位符
- 支持动态表格行克隆
- 支持Word文档和Base64编码两种输出格式

## 使用场景

- 将生成的不动产数据填充到Word模板
- 批量生成查询结果文档
- 自动化文档生成流程

## 参数说明

| 参数         | 类型     | 默认值                                | 说明                                                 |
| ------------ | -------- | ------------------------------------- | ---------------------------------------------------- |
| templatePath | 文本输入 | templates/不动产信息查询结果模板.docx | Word模板文件的相对路径                               |
| dataSource   | 下拉选择 | input                                 | 数据来源：从输入文本解析JSON或使用固定数据           |
| fixedData    | 文本输入 | ''                                    | 当数据来源为"使用固定数据"时，在此输入JSON格式的数据 |
| outputFormat | 下拉选择 | word                                  | 输出格式：Word文档或Base64编码                       |

## 输出示例

### Word文档格式

```
Word文档已生成: /tmp/word_filler_xxx/不动产查询表_001.docx
```

### Base64编码格式

```
Base64编码的Word文档:
UEsDBBQAG8I...
```

## Word模板占位符

### 段落占位符

- `{{省份}}` - 省份名称
- `{{姓名（证件号码）}}` - 姓名和证件号码
- `{{查询目的}}` - 查询目的
- `{{姓名}}` - 姓名（不含证件号码）
- `{{电脑查册人}}` - 电脑查册人
- `{{证明流水号}}` - 证明流水号
- `{{打印日期}}` - 打印日期

### 表格占位符

- `{{序号}}` - 序号
- `{{状态}}` - 状态
- `{{合同号}}` - 合同号
- `{{地址}}` - 地址
- `{{产权证号}}` - 产权证号
- `{{规划用途}}` - 规划用途
- `{{建筑面积}}` - 建筑面积
- `{{数据来源}}` - 数据来源

## 注意事项

1. 需要确保Word模板文件路径正确
2. Word模板中的占位符格式为 `{{占位符}}`
3. 表格行克隆逻辑会自动处理多行数据
4. 标题段落（包含"不动产信息查询结果"）会自动加粗
5. 表格1的第一行（列名行）会自动加粗
6. 表格3的所有单元格会自动加粗
7. 输出为Word文档格式时，文件路径会保存到 `sample['export_path']`
8. 输出为Base64编码格式时，编码结果会保存到 `sample['text']`

## 版本历史

- v1.0.0: 首次发布
    - 支持Word模板填充功能
    - 支持从输入文本解析JSON或使用固定数据
    - 支持Word文档和Base64编码两种输出格式
    - 支持动态表格行克隆
